# CharDetect_-_Divide

è¿™æ˜¯ä¸€ä¸ªç”¨äºæ‰‹å†™æ–‡å­—å›¾åƒå¤„ç†çš„æ·±åº¦å­¦ä¹ é¡¹ç›®ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬æ–‡å­—æå–ã€ç¬”ç”»åˆ†å‰²å’Œå›¾åƒé£æ ¼è½¬æ¢ã€‚æœ¬é¡¹ç›®åŸºäº UNet ç½‘ç»œç»“æ„è¿›è¡Œè®­ç»ƒï¼Œå¹¶ç»“åˆ Flask æ¡†æ¶å’ŒNext.jså®ç°äº†ä¸€ä¸ªç®€å•çš„ Web åº”ç”¨ã€‚

---

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
CharDetect_&_Divide/
â”œâ”€â”€ src/                  # æ ¸å¿ƒä»£ç æ¨¡å—
â”‚   â”œâ”€â”€ model/              # æ¨¡å‹å®šä¹‰ï¼ˆUNetï¼‰
â”‚   â”œâ”€â”€ tools/              # å·¥å…·å‡½æ•°ï¼ˆKMeans è¿‡æ»¤å™¨ã€å›¾åƒè°ƒæ•´ç­‰ï¼‰
â”‚   â”œâ”€â”€ Detecter.py         # æ–‡å­—æ£€æµ‹æ¨¡å—
â”‚   â”œâ”€â”€ Divider.py          # ç¬”ç”»åˆ†å‰²æ¨¡å—
â”‚   â”œâ”€â”€ StyleTansform.py    # é£æ ¼è¿ç§»ä¸å¢å¼ºæ¨¡å—
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ train/                # è®­ç»ƒç›¸å…³ä»£ç 
â”‚   â”œâ”€â”€ data/               # æ•°æ®é›†å·¥å…·å’Œé¢„å¤„ç†è„šæœ¬
â”‚   â””â”€â”€ src/                # æ¨¡å‹è®­ç»ƒé€»è¾‘
â”‚        â””â”€â”€ main.py        # ä¸»è®­ç»ƒè„šæœ¬
â”œâ”€â”€ front/                # å‰ç«¯ç•Œé¢
â”œâ”€â”€ paper/                # ç ”ç©¶æŠ¥å‘Š
â”œâ”€â”€ app.py                # Flask åç«¯æœåŠ¡å…¥å£
â”œâ”€â”€ install.py            # Python ä¾èµ–å®‰è£…è„šæœ¬
â”œâ”€â”€ requirements.txt      # Python ä¾èµ–è¦æ±‚
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```


---

## ğŸ”§ åŠŸèƒ½æ¨¡å—ä»‹ç»

### 1. `Divider.py` - ç¬”ç”»åˆ†å‰²æ¨¡å—
- ä½¿ç”¨è®­ç»ƒå¥½çš„ UNet æ¨¡å‹å¯¹è¾“å…¥å›¾åƒè¿›è¡Œåƒç´ çº§è¯­ä¹‰åˆ†å‰²ã€‚
- æ”¯æŒå°†å›¾åƒåˆ†å‰²ä¸ºå¤šä¸ªç±»åˆ«ï¼ˆå¦‚5ç±»ç¬”ç”»+å…³é”®ç‚¹ï¼‰ã€‚
- è¾“å‡ºæ¯ä¸ªç±»åˆ«çš„äºŒå€¼æ©ç å›¾åƒã€‚

### 2. [Detecter.py](file://C:\Users\Lenovo\PycharmProjects\CharDetect_&_Divide\src\Detecter.py) - æ–‡å­—æ£€æµ‹æ¨¡å—
- é€šè¿‡K-meansèšç±»åŠOpenCVæ–¹æ³•å®ç°äº†æ–‡å­—åŒºåŸŸçš„æå–ä¸å®šä½ã€‚

![](pic/4.png)

![](pic/5.png)

- æ”¯æŒä»å¤æ‚èƒŒæ™¯ä¸­æå–å‡ºæ–‡å­—åŒºåŸŸå¹¶è¿›è¡Œè£å‰ªã€‚

![](pic/6.png)

- å¯é…åˆ `tools` ä¸­çš„ [resize.py](file://C:\Users\Lenovo\PycharmProjects\CharDetect_&_Divide\src\tools\resize.py) è°ƒæ•´è¾“å‡ºå°ºå¯¸ã€‚

### 3. [StyleTansform.py](file://C:\Users\Lenovo\PycharmProjects\CharDetect_&_Divide\src\StyleTansform.py) - é£æ ¼è¿ç§»æ¨¡å—
- æä¾›å›¾åƒé£æ ¼å¢å¼ºåŠŸèƒ½ï¼ˆå¦‚å¯¹æ¯”åº¦å¢å¼ºã€è¾¹ç¼˜é”åŒ–ç­‰ï¼‰ã€‚
- æ”¯æŒå¤šç§é£æ ¼é€‰é¡¹ï¼Œå¯é€šè¿‡ API å‚æ•°æŒ‡å®šã€‚

### 4. `Flask App` - Web åç«¯æœåŠ¡
- æä¾› `/api/detect` å’Œ `/api/divide` æ¥å£ç”¨äºè°ƒç”¨å›¾åƒå¤„ç†æµç¨‹ã€‚

---

## ğŸ§ª æ¨¡å‹è®­ç»ƒ

æ¨¡å‹ä½¿ç”¨ PyTorch æ„å»ºï¼ŒåŸºäº UNet ç»“æ„ï¼Œå¹¶åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥äº†æ³¨æ„åŠ›æœºåˆ¶ï¼ˆSE Blockï¼‰å’ŒåŠ æƒäº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚

### æ¨¡å‹ç»„ä»¶
- **UNet**: ä¸»å¹²ç½‘ç»œï¼Œæ”¯æŒåŒçº¿æ€§æ’å€¼æˆ–è½¬ç½®å·ç§¯ä¸Šé‡‡æ ·ï¼Œåœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†4å±‚ä¸‹é‡‡æ ·åŠ4å±‚ä¸Šé‡‡æ ·ã€‚

![](pic/1.png)

- **SEBlock**: æ³¨æ„åŠ›æœºåˆ¶æ¨¡å—ï¼Œæå‡ç‰¹å¾è¡¨è¾¾èƒ½åŠ›ã€‚
- **WeightedBCEWithLogitsLoss**: è‡ªå®šä¹‰æŸå¤±å‡½æ•°ï¼Œè€ƒè™‘ä¸åŒç±»åˆ«æƒé‡ä¸å¹³è¡¡é—®é¢˜ã€‚

![](pic/2.png)

### æ•°æ®é›†
- æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªflutteråº”ç”¨ï¼Œç”¨äºæ”¶é›†å¸¦æ‹†åˆ†ç¬”ç”»çš„æ‰‹å†™æ•°æ®é›†ï¼ˆç”±äºä¸»è¦å®ç°æ–¹å¼å¹¶æœªæ¶‰åŠè¿‡å¤šå›¾åƒå¤„ç†åŸç†ï¼Œæ•…ä»£ç æœªå±•ç¤ºåˆ°æœ¬ä»“åº“ä¸­ï¼‰
- ç›®å‰å·²æ”¶é›†è¿‘500å¼ çš„å°è§„æ¨¡æ•°æ®é›†ï¼ŒåŒ…å«400ä¸ªæ ‡å‡†å­—åŠ60ä¸ªéšæœºå­—

### è®­ç»ƒæ–¹å¼
- ä½¿ç”¨ Adam ä¼˜åŒ–å™¨ + ReduceLROnPlateau å­¦ä¹ ç‡è°ƒåº¦å™¨ã€‚
- åœ¨Apple Silicon(M3 pro)å¹³å°è®­ç»ƒ24è½®

### è®­ç»ƒæ•ˆæœ

- ç›®å‰ï¼Œæ¨¡å‹å¯¹ç¬”ç”»è¾ƒä¸ºç®€å•çš„å­—ä½“å·²ç»èƒ½å¤Ÿæœ‰è¾ƒå¥½çš„æ‹Ÿåˆæ•ˆæœ

![](pic/7.png)

---

## ğŸ“„ ç ”ç©¶æŠ¥å‘ŠåŠé¡¹ç›®åˆ›æ–°ç‚¹

- è¯·å‰å¾€paperç›®å½•ä¸‹æŸ¥çœ‹

## ğŸ“¦ ä¾èµ–å®‰è£…

**1. Pythonä¾èµ–**

```bash
python install.py
```


> æ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼ˆvenv æˆ– condaï¼‰ç®¡ç†ä¾èµ–ã€‚

**2. Nodeä¾èµ–**

```bash
cd front
npm install
```


> å¦‚å®‰è£…è¿‡æ…¢ï¼Œè¯·åˆ‡æ¢åˆ°å›½å†…æº

---

## â–¶ï¸ è¿è¡Œé¡¹ç›®

### å¯åŠ¨åç«¯æœåŠ¡

```bash
cd CharDetect_&_Divide
python app.py
```


æœåŠ¡é»˜è®¤è¿è¡Œåœ¨ `http://localhost:5000`

### å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd CharDetect_&_Divide/front
npm run dev
```

æµè§ˆå™¨è¾“å…¥`http://localhost:3000`

![](pic/3.png)

---

## ğŸ“Œ ä½¿ç”¨ç¤ºä¾‹ï¼ˆAPIï¼‰

### ç¤ºä¾‹è¯·æ±‚ï¼ˆPOSTï¼‰

#### `/api/detect`
```json
{
  "image": "<file>",
  "width": "256",
  "height": "256",
  "style": "enhance"
}
```


#### `/api/divide`
```json
{
  "image": "<file>",
  "width": "256",
  "height": "256"
}
```


å“åº”æ ¼å¼ï¼š
```json
{
  "processed_images": [
    "data:image/png;base64,...",
    ...
  ]
}
```


---

## ğŸ§© åæœŸè®¡åˆ’

- å°†æ•°æ®é›†æ‰©å±•åˆ°1200å¼ è®­ç»ƒåé€šè¿‡åŠç›‘ç£å­¦ä¹ è¿›è¡Œæ•°æ®é›†æ‰©å……
- ä½¿ç”¨GANç”Ÿæˆç¬¬äº”ç±»ç¬”ç”»ï¼Œåœ¨UNetæ¨¡å‹è¾“å‡ºä¸­æŠ›å¼ƒç¬¬äº”ç±»ç¬”ç”»ï¼ˆå¤æ‚ç¬”ç”»ï¼‰ï¼Œå‡è½»UNetçš„æ‹Ÿåˆéš¾åº¦

---

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ issue æˆ–è”ç³»ä½œè€…ã€‚æ¬¢è¿è´¡çŒ®ä»£ç ï¼
